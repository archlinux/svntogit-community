# $Id$
# Maintainer: Sergej Pupykin <pupykin.s+arch@gmail.com>
# Contributor: Jacek Poplawski <jacekpoplawski@gmail.com>
# Contributor: Charlie Cox <ccoxiv@yahoo.com>

pkgname=atanks
pkgver=5.0
pkgrel=1
pkgdesc="Atomic Tanks"
url="http://atanks.sourceforge.net"
license=('GPL')
arch=('i686' 'x86_64')
makedepends=('sed')
depends=('allegro>=4.4.0.1' 'gcc-libs')
source=("http://downloads.sourceforge.net/project/atanks/atanks/atanks-${pkgver}/atanks-${pkgver}.tar.gz")
md5sums=('1978fabfb5ab2c33bd079eb492ee4362')

build() {
  cd atanks-${pkgver}

  #debug messages fix
  #sed -i '/lines->Display_All(TRUE)/d' src/files.cpp
  #sed -i '/Scroll Offset:/d' src/files.cpp
  #sed -i '/T offset:/d' src/files.cpp
  #
  #sed -i '1,1i#include <sys/stat.h>' src/files.cpp

  make
}

package() {
  cd atanks-${pkgver}

  make PREFIX=${pkgdir}/usr/ INSTALL="install -c" install

  sed -i 's/^Name=atanks/Name=Atomic Tanks/' atanks.desktop
  sed -i 's/^Categories=Game;/Categories=Game;StrategyGame;/' atanks.desktop

  install -Dm644 atanks.desktop \
    $pkgdir/usr/share/applications/atanks.desktop
  install -Dm644 atanks.png \
    $pkgdir/usr/share/pixmaps/atanks.png
}
