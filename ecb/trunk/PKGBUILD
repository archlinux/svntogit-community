# $Id$
# Maintainer: Sergej Pupykin <pupykin.s+arch@gmail.com>

pkgname=ecb
pkgver=2.40.1pre
pkgrel=2
pkgdesc="Emacs Code Browser"
arch=('any')
url="http://ecb.sourceforge.net/"
depends=('emacs' 'cedet')
license=('GPL')
install=ecb.install
#source=(http://downloads.sourceforge.net/ecb/$pkgname-$pkgver.tar.gz)
source=(http://ecb.sourceforge.net/cvs_snapshots/ecb.tar.gz)
md5sums=('cd5f6594773e2abc9bfebac422ccaa79')

build() {
  local _emacsver=`pacman -Q emacs | cut -d- -f 1 | cut -d\  -f2`

#  cd $srcdir/$pkgname-$pkgver
  cd $srcdir/$pkgname-snap
  mkdir -p $pkgdir/usr/share/emacs/site-lisp/ecb

#  make CEDET=/usr/share/emacs/${_emacsver}/lisp/cedet ecb
  make CEDET=/usr/share/emacs/site-lisp/cedet ecb
  cp -R $srcdir/$pkgname-snap/* $pkgdir/usr/share/emacs/site-lisp/ecb
  find $pkgdir/usr/share -type f -exec chmod 0644 {} \;
  find $pkgdir/usr/share -type d -exec chmod 0755 {} \;
}
