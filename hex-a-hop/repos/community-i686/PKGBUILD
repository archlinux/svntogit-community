# $Id$
# Maintainer: Sergej Pupykin <pupykin.s+arch@gmail.com>
# Contributor: insulae <insulae@gmail.com>

pkgname=hex-a-hop
pkgver=20070705
pkgrel=7
pkgdesc="Hex-a-hop is a puzzle game based on hexagonal tiles"
arch=(i686 x86_64)
url="http://packages.debian.org/testing/games/hex-a-hop"
license=('GPL')
depends=('sdl' 'gcc-libs' 'sh')
makedepends=()
options=()
source=(http://archlinux-stuff.googlecode.com/files/hex-a-hop.tar.gz \
	arch.patch)
md5sums=('4e9f11dcd85217b7f0c5461edc961822'
         'f3ad6484b3bb8459d6f45a808c338954')

build() {
  cd $startdir/src/$pkgname

  patch -Np1 <../arch.patch

  make || return 1

  mkdir -p $startdir/pkg/usr/{share,bin}
  mkdir -p $startdir/pkg/usr/share/hex-a-hop

  install -D -m 755 Hex-a-hop $startdir/pkg/usr/lib/hex-a-hop/Hex-a-hop || return 1
  ln -sf /usr/lib/hex-a-hop/Hex-a-hop $pkgdir/usr/share/hex-a-hop/Hex-a-hop || return 1
  install -D -m 644 levels.dat $startdir/pkg/usr/share/hex-a-hop || return 1 
  cp -r graphics $startdir/pkg/usr/share/hex-a-hop || return 1 

  cat >$startdir/pkg/usr/bin/hex-a-hop <<EOF || return 1
#!/bin/sh
mkdir -p \$HOME/.hex-a-hop && \
exec /usr/share/hex-a-hop/Hex-a-hop \$HOME/.hex-a-hop
EOF
  chmod 775 $startdir/pkg/usr/bin/hex-a-hop || return 1

  cd $startdir/pkg/usr/share/hex-a-hop/graphics && \
  chmod 644 *.*
}
