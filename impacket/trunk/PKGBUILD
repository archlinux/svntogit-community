# Maintainer: Levente Polyak <anthraxx[at]archlinux[dot]org>
# Contributor: Sirat18 <aur@sirat18.de>
# Contributor: Paolo Giangrandi <peoro.noob@gmail.com>

pkgname=impacket
pkgver=0.10.0
pkgrel=1
pkgdesc='Collection of classes for working with network protocols'
url='https://github.com/CoreSecurity/impacket'
arch=('any')
license=('Apache')
depends=('python' 'python-pycryptodome' 'python-pycryptodomex' 'python-pyasn1'
         'python-pcapy' 'python-pyopenssl' 'python-six' 'python-ldap3' 'python-flask')
checkdepends=('python-pytest' 'python-pytest-runner' 'python-cryptography')
source=(https://github.com/CoreSecurity/impacket/archive/impacket_${pkgver//./_}.tar.gz)
sha256sums=('2939d3969f3311841e160d94ffbe4f27bb79e97fb1958ce89bbb7f3fb2f5214b')
sha512sums=('e195a471b37cd1f5758c3c7753cb397cff9c5be1cba27bc1c987d1d38ae466941669ccd5cde14df6f05017f953423a72608075c9fa63b3fd176a13106f90dc16')

build() {
  cd ${pkgname}-${pkgname}_${pkgver//./_}
  python setup.py build
}

package() {
  cd ${pkgname}-${pkgname}_${pkgver//./_}
  python setup.py install -O1 --root="${pkgdir}" --skip-build
  install -Dm 644 ChangeLog.md -t "${pkgdir}/usr/share/doc/${pkgname}"
  local PYTHONVERSION="$(python -c 'import sys; print("{}.{}".format(sys.version_info.major, sys.version_info.minor))')"
  ln -s "/usr/lib/python${PYTHONVERSION}/site-packages/impacket/examples" "${pkgdir}/usr/share/doc/${pkgname}/examples"
}

# vim: ts=2 sw=2 et:
