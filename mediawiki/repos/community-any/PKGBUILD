# $Id$
# Maintainer: Sergej Pupykin <pupykin.s+arch@gmail.com>
# Contributor: Sergej Pupykin <pupykin.s+arch@gmail.com>

pkgname=mediawiki
pkgver=1.17.0
pkgrel=1
pkgdesc="MediaWiki engine"
arch=('any')
url="http://www.mediawiki.org/wiki/MediaWiki"
license=("GPL")
depends=(php)
optdepends=('texvc: for math rendering'
	    'python2')
backup=(srv/http/mediawiki/.htaccess)
install=mediawiki.install
source=(http://download.wikimedia.org/mediawiki/1.17/mediawiki-$pkgver.tar.gz)
md5sums=('871a00a8eb6dcae1b7b654ae635af7cd')

build() {
  cd $srcdir
  sed -i -e 's#is_executable#is_file#' -e 's#is_executable#is_file#' $pkgname-$pkgver/includes/Math.php
  install -d -m0755 $pkgdir/srv/http
  cp -a $pkgname-$pkgver $pkgdir/srv/http/mediawiki
  ln -s /usr/bin/texvc $pkgdir/srv/http/mediawiki/math/texvc
  chmod 0777 $pkgdir/srv/http/mediawiki/images
  echo "deny from all" >> $pkgdir/srv/http/mediawiki/.htaccess
}
