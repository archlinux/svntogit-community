# $Id$
# Maintainer: Eric BÃ©langer <eric@archlinux.org>
# Contributor: Jaroslav Lichtblau <dragonlord@aur.archlinux.org>

pkgname=qingy
pkgver=1.0.0
pkgrel=5
pkgdesc="A DirectFB getty replacement"
arch=('i686' 'x86_64')
url="http://qingy.sourceforge.net/"
license=('GPL')
depends=('directfb' 'openssl' 'libxss')
makedepends=('emacs')
backup=('etc/qingy/settings' 'etc/qingy/welcomes')
options=('!libtool')
install=qingy.install
source=(http://downloads.sourceforge.net/sourceforge/qingy/${pkgname}-${pkgver}.tar.bz2 \
        qingy.logrotate)
md5sums=('1e0912655e240adfd0ce5ced30bbc685'
         'a9bdfd0ac9f29380eafa97a4a056789d')

build() {
  cd "${srcdir}/${pkgname}-${pkgver}"
  sed -i 's|/lib/security/||' media/pam/default/qingy
  XFREE=/usr/bin/Xorg XINIT=/usr/bin/xinit \
    ./configure --prefix=/usr --sbindir=/sbin --sysconfdir=/etc \
    --disable-optimizations --enable-pam \
    --disable-static-build --enable-gpm-lock --enable-emacs
  make
}

package() {
  cd "${srcdir}/${pkgname}-${pkgver}"
  make DESTDIR="${pkgdir}" install
  install -D -m644 "${srcdir}/qingy.logrotate" "${pkgdir}/etc/logrotate.d/qingy"
}
