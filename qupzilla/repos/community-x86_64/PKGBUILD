# $Id$
# Maintainer: speps <speps at aur dot archlinux dot org>
# Maintainer: Antonio Rojas <arojas@archlinux.org>

pkgname=qupzilla
pkgver=2.2.0
pkgrel=2
pkgdesc="Cross-platform QtWebEngine browser"
arch=(i686 x86_64)
url="http://www.qupzilla.com/"
license=(GPL3)
depends=(qt5-webengine qt5-x11extras qt5-svg)
makedepends=(qt5-tools kwallet libgnome-keyring)
optdepends=('bash-completion: bash completion support' 'kwallet: kf5 kwallet integration'
            'libgnome-keyring: gnome keyring integration')
source=(https://github.com/QupZilla/qupzilla/releases/download/v$pkgver/QupZilla-$pkgver.tar.xz)
sha256sums=('32cb6d4e5852781146ca5f1a1cf8e77da42a71fc096272e2030d83ea865c7818')

build() {
  cd QupZilla-$pkgver
  export USE_WEBGL=true \
    QUPZILLA_PREFIX=/usr/ \
    KDE_INTEGRATION=true \
    GNOME_INTEGRATION=true
  qmake
  make
}

package() {
  cd QupZilla-$pkgver
  make INSTALL_ROOT="$pkgdir/" install

  # zsh completion
  install -Dm644 linux/completion/_$pkgbase \
    "$pkgdir/usr/share/zsh/site-functions/_$pkgbase"
}
