# $Id$
# Maintainer: Sergej Pupykin <pupykin.s+arch@gmail.com>
# Contributor: Baptiste Grenier <baptiste@bapt.name>

pkgname=rubber
pkgver=1.2
pkgrel=1
pkgdesc="A wrapper for LaTeX and friends"
arch=('any')
url="https://launchpad.net/rubber/"
license=('GPL')
depends=('python2')
makedepends=('texinfo')
source=("http://launchpad.net/rubber/trunk/$pkgver/+download/rubber-$pkgver.tar.gz"
	"rubber-1.1-spaces.patch"
	"md5tohashlib.patch")
md5sums=('f553660164c8686b7155cdbce284adc9'
         '743f644122ba27c783748ac33510e4e8'
         '5478bafce24f09501d8c8d6075492a77')

build() {
  cd "${srcdir}"
#  patch -N -i "${srcdir}/rubber-1.1-spaces.patch" "${srcdir}/${pkgname}-${pkgver}/src/rules/latex/__init__.py"
#  patch -N -i "${srcdir}/md5tohashlib.patch" "${srcdir}/${pkgname}-${pkgver}/src/util.py"
  ./configure --prefix=/usr --mandir="${pkgdir}/usr/share/man" --infodir="${pkgdir}/usr/share/info"
  make
}

package() {
  cd "${srcdir}"
  make prefix="${pkgdir}/usr" install
  mkdir -p $pkgdir/usr/share/bash-completion/completions/
  echo "complete -f -X '!*.tex' rubber" >$pkgdir/usr/share/bash-completion/completions/rubber
}
