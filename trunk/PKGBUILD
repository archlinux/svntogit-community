# $Id$
# Maintainer:  Bart≈Çomiej Piotrowski <nospam@bpiotrowski.pl>
# Contributor: Brad Fanella <bradfanella@archlinux.us>
# Contributor: Stefan Husmann <stefan-husmann@t-online.de>
# Contributor: Pierre-Paul Paquin <pierrepaulpaquin@gmail.com>
# Contributor: xduugu (.desktop and install files)

pkgname=mupdf
pkgver=1.1
pkgrel=1
pkgdesc="lightweight PDF viewer and toolkit written in portable C"
arch=('i686' 'x86_64')
url="http://mupdf.com"
license=('GPL3')
depends=('freetype2' 'libjpeg' 'jbig2dec' 'openjpeg' 'libxext' 'desktop-file-utils' 'xdg-utils')
install=mupdf.install
source=("http://mupdf.com/download/$pkgname-$pkgver-source.tar.gz")
md5sums=('f7b5fd753f40aca207e9afd70d8f8edf')

build() {
    CFLAGS+=" -fPIC"
    CXXFLAGS+=" -fPIC"

	cd "$srcdir"/$pkgname-$pkgver-source
	make build=release prefix=/usr
}

package() {
	cd "$srcdir"/$pkgname-$pkgver-source
	make build=release prefix="$pkgdir"/usr install

	sed -i 's/mupdf.xpm/mupdf/' debian/mupdf.desktop
  	sed -i 's/application\/x-pdf/application\/x-pdf/' debian/mupdf.desktop

	install -Dm644 debian/mupdf.desktop "$pkgdir"/usr/share/applications/mupdf.desktop
  	install -Dm644 debian/mupdf.xpm "$pkgdir"/usr/share/pixmaps/mupdf.xpm

    chmod 644 "$pkgdir"/usr/lib/libfitz.a
}
