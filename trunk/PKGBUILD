# Contributor: Guillermo A. Amaral (thewonka) <me@guillermoamaral.com>
# Contributor: Adam Griffiths <adam_griffithsAATTdart.net.au>

pkgname=tinyxml
pkgver=2.5.3
_pkgver=2_5_3
pkgrel=2
pkgdesc="A simple, small, C++ XML parser that can be easily integrating into other programs"
url='http://www.grinninglizard.com/tinyxml/'
arch=('i686' 'x86_64')
license=('zlib')
source=("http://downloads.sourceforge.net/$pkgname/${pkgname}_${_pkgver}.tar.gz"
        "x86-64.patch")
md5sums=('84b605a31628e7f1a6694d47bf5999cc'
         '1a4bd141eddea7ce53d04f2cf91c7868')

build(){
cd $srcdir/$pkgname

patch -Np0 -i $srcdir/x86-64.patch
install -d $pkgdir/usr/include/tinyxml
cp {*.h,*.cpp} $pkgdir/usr/include/tinyxml || return 1
rm $pkgdir/usr/include/tinyxml/xmltest.cpp

make -j1 || return 1

# building the library
g++ -shared -o libtinyxml.so.0.$pkgver -Wl,-soname,libtinyxml.so.0 *.cpp
install -d $pkgdir/usr/lib
install -m755 libtinyxml.so.0.$pkgver $pkgdir/usr/lib/ || return 1
ln -s /usr/lib/libtinyxml.so.0.$pkgver $pkgdir/usr/lib/libtinyxml.so.0 || return 1
ln -s /usr/lib/libtinyxml.so.0.$pkgver $pkgdir/usr/lib/libtinyxml.so || return 1
} 
